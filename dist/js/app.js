const Enemy=function(e,t,r){this.x=e,this.y=t,this.v=r,this.sprite="images/enemy-bug.png"};Enemy.prototype.update=function(e){this.x<ctx.canvas.width&&(this.x+=this.v*e)},Enemy.prototype.render=function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)};const Player=function(e,t){this.sprite=null,this.x=e,this.y=t,this.sprite="images/char-boy.png"};Player.prototype.update=function(){player.y<=-23&&(document.querySelector("#success").play(),generatePlayerLocation("success")),this.x=this.x<0?0:this.x>=ctx.canvas.width?ctx.canvas.width-101:this.x,this.y=this.y<-23?-23:this.y>=ctx.canvas.height-226?ctx.canvas.height-226:this.y},Player.prototype.render=function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)},Player.prototype.handleInput=function(e){switch(e){case"left":this.x-=101;break;case"up":this.y-=83;break;case"right":this.x+=101;break;case"down":this.y+=83}};const Collectible=function(e,t,r){this.x=e,this.y=t,this.sprite=r};Collectible.prototype.render=function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)};const allEnemies=[];setInterval(()=>{const e=[60,143,226],t=e[Math.floor(Math.random()*e.length)],r=300*Math.random()+300,a=new Enemy(-101,t,r);allEnemies.push(a)},1e3);let player=new Player(101*Math.floor(5*Math.random()),380);player.score=0,player.lives=3;const allGems=[];["Blue","Green","Orange"].forEach(e=>{allGems.push(new Collectible(101*Math.floor(5*Math.random()),83*Math.floor(3*Math.random()+1)-23,"images/Gem-"+e+".png"))});const lives=new Collectible(101*Math.floor(5*Math.random()),83*Math.floor(3*Math.random()+1)-23,"images/Heart.png");function startGame(){const e=document.querySelector("#play-button");e.addEventListener("click",()=>{if(e.setAttribute("style","display: none"),document.querySelector("#background").play(),window.innerWidth<560){document.querySelector(".container").innerHTML="Snap!<br><br>Your device is too small and needs a keyboard to play this game.<br><br>¯\\_(ツ)_/¯"}else introduction()})}function introduction(){$(".typed").typed({strings:["A long time ago, in an island far, far away...It is a period of war for survival between enemy-bugs and humans. During the battle, a small group of spies managed to steal a secret map to all the 3 Pesticide Gems. Whoever holds all the gems shall possess the power to destroy the entire population of bugs and restore freedom to the island...<br>Your mission is to find the 3 gems by leveling up and destroy the tyrant bugs once and for all!"],typeSpeed:30,startDelay:50,showCursor:!1,cursorChar:"|",contentType:"html"});const e=document.querySelector(".container"),t=document.querySelector("form"),r=document.querySelector("input"),a=document.querySelector("#submit-button");t.setAttribute("style","display: all"),a.addEventListener("click",t=>{t.preventDefault(),player.name=r.value,player.name?(e.innerHTML="<h3>Hi "+player.name+'!<br> select avatar</h3> <div id="carouselControls" class="carousel slide" data-ride="carousel"> <div class="carousel-inner"> <div class="carousel-item active"> <img src="images/char-boy.png" alt="boy"> </div><div class="carousel-item"> <img src="images/char-cat-girl.png" alt="cat-girl"> </div><div class="carousel-item"> <img src="images/char-horn-girl.png" alt="horn-girl"> </div><div class="carousel-item"> <img src="images/char-pink-girl.png" alt="pink-girl"> </div><div class="carousel-item"> <img src="images/char-princess-girl.png" alt="princess-girl"> </div></div><a class="carousel-control-prev" href="#carouselControls" role="button" data-slide="prev"> <span class="carousel-control-prev-icon" aria-hidden="true"></span> <span class="sr-only">Previous</span> </a> <a class="carousel-control-next" href="#carouselControls" role="button" data-slide="next"> <span class="carousel-control-next-icon" aria-hidden="true"></span> <span class="sr-only">Next</span> </a> </div>',selectPlayer()):alert("Please Enter Your Name.\nWe can't read minds you know!")})}function selectPlayer(){const e=document.querySelectorAll("img"),t=document.querySelector("#score-panel"),r=document.querySelector("#hearts"),a=document.querySelector(".container");Array.prototype.slice.call(e).forEach(e=>{e.addEventListener("click",()=>{player.sprite=e.getAttribute("src"),a.setAttribute("style","display: none"),ctx.canvas.setAttribute("style","display: all"),t.setAttribute("style","display: all");for(var n=0;n<player.lives;n++)r.innerHTML+='<img src="images/Heart.png">';document.querySelector("html").webkitRequestFullscreen()})})}function checkItem(e){if(Math.abs(e.x-player.x)<51&&12==Math.abs(e.y-player.y)){if(document.querySelector("#level-up").play(),e.render=(()=>!0),e==lives){const e=document.querySelector("#hearts");player.lives+=1,e.innerHTML="";for(var t=0;t<player.lives;t++)e.innerHTML+='<img src="images/Heart.png">'}else{document.querySelector("#gem").innerHTML+='<img src="'+e.sprite+'">'}e.x=void 0,e.y=void 0}}function generatePlayerLocation(e){const t=document.querySelector("#score"),r=document.querySelector("#hearts");if("success"==e)player.score+=1,t.innerHTML=player.score,10==player.score&&endGame("won");else{player.lives-=1,r.innerHTML="";for(var a=0;a<player.lives;a++)r.innerHTML+='<img src="images/Heart.png">';0==player.lives&&endGame("lose")}player.x=101*Math.floor(5*Math.random()),player.y=380}function endGame(e){let t=document.querySelector("#modalCenterTitle"),r=document.querySelector(".modal-body"),a=0;const n=document.querySelector("#close-button");allGems.forEach(e=>{e.render()&&(a+=1)}),n.addEventListener("click",()=>window.open(window.location.href,"_self")),"won"==e?(3==a?(t.innerHTML="Congratulations, "+player.name+"!",r.innerHTML="You've made it... It is because of you the long gone peace has been finally restored!"):(t.innerHTML="Hey, "+player.name+"!",r.innerHTML="Your effort is uncomparable but you must collect all the gems in order to win this battle!"),document.querySelector("#modal-button").click()):(t.innerHTML="Oh, "+player.name+"!",r.innerHTML="...what have you done!<br>We lost!",document.querySelector("#modal-button").click())}document.addEventListener("keyup",e=>{player.handleInput({37:"left",38:"up",39:"right",40:"down",65:"left",87:"up",68:"right",83:"down"}[e.keyCode])});